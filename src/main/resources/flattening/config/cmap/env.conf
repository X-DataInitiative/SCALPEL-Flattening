output_path = "/shared/Observapur/test_data"

schema_file_path = [
  "flattening/config/schema/DCIR_schema.csv"
  "flattening/config/schema/PMSI_schema.csv"
]

tables_config = [
  {include "dcir.conf"}
  {include "pmsi_mco.conf"}
]

join = [
  {
    name = "DCIR"
    yearPartitionCol = "FLX_TRT_DTD"
    monthPartitionCol = ""

    main_table = {
      path = "/shared/Observapur/parquet_data/ER_PRS_F"
      name = "ER_PRS_F"
      primaryKey = ["DCT_ORD_NUM", "FLX_DIS_DTD", "FLX_EMT_NUM", "FLX_EMT_ORD", "FLX_EMT_TYP", "FLX_TRT_DTD", "ORG_CLE_NUM", "PRS_ORD_NUM", "REM_TYP_AFF"]
    }

    tablesToJoin = [
      {
        name = "ER_PHA_F"
        path = "/shared/Observapur/parquet_data/ER_PHA_F"
        foreignKeys = ["DCT_ORD_NUM", "FLX_DIS_DTD", "FLX_EMT_NUM", "FLX_EMT_ORD", "FLX_EMT_TYP", "FLX_TRT_DTD", "ORG_CLE_NUM", "PRS_ORD_NUM", "REM_TYP_AFF"]
      }
      ,
      {
        name = "ER_CAM_F"
        path = "/shared/Observapur/parquet_data/ER_CAM_F"
        foreignKeys = ["DCT_ORD_NUM", "FLX_DIS_DTD", "FLX_EMT_NUM", "FLX_EMT_ORD", "FLX_EMT_TYP", "FLX_TRT_DTD", "ORG_CLE_NUM", "PRS_ORD_NUM", "REM_TYP_AFF"]
      }
    ]

    outputPath = "/shared/Observapur/flat_data/"
  }

]